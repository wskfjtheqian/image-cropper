<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>image-cropper</title>
</head>
<body style="display: flex">
<canvas id="image-cropper" style="width: 800px; height: 600px;"></canvas>
<button id="reset-button">Reset</button>
<img id="image-preview" src="" alt="Preview" style="display: none; width: 300px; height: 300px; object-fit: contain;">


<script type="module" src="/src/image-cropper.ts"></script>
<script type="module">
    import ImageCropper from "./src/image-cropper.js";

    const cropper = new ImageCropper(document.getElementById('image-cropper'), {
        // backgroundBoxSize: 25,
        // backgroundBoxColor1: '#f47171',
        // backgroundBoxColor2: '#5b8ebf',
        // guidelineWidth: 2,
        // guidelineColor1: 'rgba(255,0,0,0.53)',
        // guidelineColor2: 'rgba(0,59,255,0.53)',
        // guidelineDsah: 8,
        // borderWidth: 1,
        // borderColor1: 'rgb(255,0,0)',
        // borderColor2: 'rgba(0,59,255,0.53)',
    });


    const image = new Image();
    image.crossOrigin = "anonymous"; // 必须在 src 之前设置
    image.src = 'https://img-s.msn.cn/tenant/amp/entityid/AA1HWO7G.img';
    cropper.setImage(image)

    setInterval(() => {
        cropper.toDataUrl().then((url) => {
            const preview = document.getElementById('image-preview')
            preview.src = "data:image/svg+xml;base64,PHN2ZyB0PSIxNzYzMzA4NTgxNTE3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE1NzAiCiAgICAgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KICAgIDxwYXRoIGQ9Ik00MjEuMTIgNTkwLjUwNjY2N0wzNjIuNjY2NjY3IDY0OC41MzMzMzNhMzI5LjM4NjY2NyAzMjkuMzg2NjY3IDAgMCAxIDIzLjQ2NjY2Ni00MDkuMTczMzMzIDguNTMzMzMzIDguNTMzMzMzIDAgMCAwLTkuODEzMzMzLTEzLjIyNjY2NyAzMTAuMTg2NjY3IDMxMC4xODY2NjcgMCAwIDAtODMuMiA0OTIuMzczMzM0TDI0MS45MiA3NjhhMTcuMDY2NjY3IDE3LjA2NjY2NyAwIDAgMCAxMS45NDY2NjcgMjkuMDEzMzMzaDE3OS4yYTE3LjA2NjY2NiAxNy4wNjY2NjcgMCAwIDAgMTcuMDY2NjY2LTE3LjA2NjY2NnYtMTc5LjJhMTcuMDY2NjY3IDE3LjA2NjY2NyAwIDAgMC0yOS4wMTMzMzMtMTAuMjR6TTYwMi44OCA0MzMuNDkzMzMzTDY2MS4zMzMzMzMgMzc1LjQ2NjY2N2EzMjkuMzg2NjY3IDMyOS4zODY2NjcgMCAwIDEtMjEuMzMzMzMzIDQwOS4xNzMzMzMgOC41MzMzMzMgOC41MzMzMzMgMCAwIDAgOS44MTMzMzMgMTMuMjI2NjY3IDMxMC4xODY2NjcgMzEwLjE4NjY2NyAwIDAgMCA4MS4wNjY2NjctNDkyLjM3MzMzNEw3ODIuMDggMjU2YTE3LjA2NjY2NyAxNy4wNjY2NjcgMCAwIDAtMTEuOTQ2NjY3LTI5LjAxMzMzM2gtMTc5LjJhMTcuMDY2NjY3IDE3LjA2NjY2NyAwIDAgMC0xNy4wNjY2NjYgMTcuMDY2NjY2djE3OS4yYTE3LjA2NjY2NyAxNy4wNjY2NjcgMCAwIDAgMjkuMDEzMzMzIDEwLjI0eiIKICAgICAgICAgIHAtaWQ9IjE1NzEiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMjAiPjwvcGF0aD4KPC9zdmc+"
            preview.style.display = 'block'
        })
    }, 33.3333)

    document.getElementById('reset-button').addEventListener('click', () => {
        cropper.reset()
        const preview = document.getElementById('image-preview')
        preview.style.display = 'none'
    })
</script>
</body>

</html>
